<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles.css">
    <script src="lib/d3.min.js"></script>
    <script src="code.js"></script>

    <script type="x-shader/x-vertex" id="shader-vs">
        attribute vec3 pos_size;
        uniform vec2 screen;
        varying vec2 location;
        varying float radius;

        void main() {
            gl_Position = vec4(pos_size.xy, 0.0, 1.0);
            location = screen * (pos_size.xy * 0.5 + 0.5);
            radius = pos_size.z / 2.0;
            gl_PointSize = radius * 2.0;
        }
    </script>
    <script type="x-shader/x-fragment" id="shader-fs">
        precision mediump float;
        uniform vec3 dot_color;
        uniform vec3 clear_color;
        varying vec2 location;
        varying float radius;

        vec3 smoothColor(float dist) { //interpolate the last view pixels for smoother dots (antialias für arme)
            float covered = dist / radius;
            float factor = 0.0;
            if(covered > 0.95) factor = (covered - 0.95) / 0.05;
            return dot_color * (1.0 - factor) + factor * clear_color;
        }

        void main() {
            float dist = distance(location, gl_FragCoord.xy); //distance to original point
            if(dist > radius) discard;

            gl_FragColor = vec4(smoothColor(dist), 1.0);
        }
    </script>
</head>

<body onload="init()">
    <header>
        <h1 class="cohesive">Stippling</h1>
        <h3 class="cohesive">by Philip Ferenz & Alexandra Irger</h3>

        <p class="italic cohesive">Based on the Paper
            <a href="https://ieeexplore.ieee.org/document/8667696" target="_blank" rel="noopener noreferrer">
                »Stippling of 2D Scalar Fields«
            </a>
            by Görtler et al.
        </p>
    </header>

    <div class="app">
        <div class="ui">
            <div>
                <h3 class="centered">Settings</h3>
            </div>
            <div>
                <input type="button" value="Upload" onclick="acceptFile()" />
                <input type="file" style="display:none;" id="iUploadImage"/>
            </div>
            <div>
                <input type="checkbox" id="iMachbanding" />
                <label for="iMachbanding">machbanding</label>
            </div>
            <div>
                <input class="reactive_range" type="range" id="iDotSize" min="1" max="100" value="50">
                <label for="iDotSize">dot size</label>
            </div>
            <div>
                <p class="centered">more settings ...</p>
            </div>
            <div>
                <p class="centered">more settings ...</p>
            </div>
            <div>
                <p class="centered">more settings ...</p>
            </div>
            <div>
                <p class="centered">more settings ...</p>
            </div>
            <div>
                <p class="centered">more settings ...</p>
            </div>
            <div>
                <p class="centered">more settings ...</p>
            </div>
            <div>
                <p class="centered">more settings ...</p>
            </div>
        </div>

        <div class="output">
            <canvas id="d3surface"></canvas>
        </div>
    </div>
</body>
</html>